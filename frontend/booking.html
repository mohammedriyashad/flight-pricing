<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SkyBook | Passenger Details</title>
  <link rel="stylesheet" href="assets/css/main.css">
</head>
<body>

<div class="loader" id="loader"></div>

<!-- NAVBAR -->
<div class="navbar">
  <div class="logo">SkyBook âœˆ</div>
  <div class="nav-links">
    <a href="index.html">Flights</a>
    <a href="history.html">My Bookings</a>
  </div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<div class="flight-summary" id="flightSummary">
  <h3>Flight Summary</h3>
  <div class="summary-row">
    <span>Route</span>
    <strong id="summaryRoute">â€”</strong>
  </div>
  <div class="summary-row">
    <span>Flight</span>
    <strong id="summaryFlight">â€”</strong>
  </div>
  <div class="summary-row">
    <span>Departure</span>
    <strong id="summaryTime">â€”</strong>
  </div>
  <div class="summary-row total">
    <span>Price</span>
    <strong id="summaryPrice">â€”</strong>
  </div>
</div>

<!-- PASSENGER CARD -->
<div class="booking-wrapper">
  <div class="booking-card">
    <h2>Passenger Details</h2>

    <div class="form-grid">
      <div>
        <label>Full Name</label>
        <input type="text" id="name" placeholder="Passenger Name">
      </div>

      <div>
        <label>Age</label>
        <input type="number" id="age" min="1">
      </div>

      <div>
        <label>Gender</label>
        <select id="gender">
          <option>Male</option>
          <option>Female</option>
          <option>Other</option>
        </select>
      </div>

      <div>
        <label>Email</label>
        <input type="email" id="email" placeholder="Registered Email">
      </div>

      <div>
        <label>No. of Seats</label>
        <input type="number" id="seats" min="1" value="1">
      </div>
    </div>

    <button type="button" class="confirm-btn" onclick="confirmBooking()">
      Confirm Booking
    </button>

    <p id="msg"></p>
  </div>
</div>
<script src="assets/js/api.js"></script>
<script src="assets/js/auth.js"></script>
<script src="assets/js/bookings.js"></script>
<script>
  const authUser = JSON.parse(localStorage.getItem("authUser"));

  if (!authUser) {
    window.location.href = "login.html";
  } else {
    const emailInput = document.getElementById("email");
    emailInput.value = authUser.email;
    emailInput.readOnly = true;        // ðŸ”’ locked to registered email
    emailInput.style.background = "#f3f4f6"; // optional UI cue
  }
</script>
<script>
  const flight = JSON.parse(localStorage.getItem("selectedFlightData"));

  if (flight) {
    document.getElementById("summaryRoute").innerText =
      `${flight.origin_code} â†’ ${flight.dest_code}`;

    document.getElementById("summaryFlight").innerText =
      `${flight.airline} ${flight.flight_number}`;

    document.getElementById("summaryTime").innerText =
      flight.departure_time;

    document.getElementById("summaryPrice").innerText =
      `â‚¹ ${flight.price}`;
  }
</script>
</body>
</html>